---
title: "Fifth Week: Bootstrap and Resampling Methods"
subtitle: "Nonparametric Hypothesis tests"
author: "95107188"
date: "`r Sys.time()`"
output:
  prettydoc::html_pretty:
    theme: cayman
    highlight: github
---


> <p dir="RTL"> 
لطفا با سوالات زیر پاسخ دهید.
در همه سوالات سطح دقت را ۹۵ درصد در نظر بگیرید.
</p>

***
```{r, message=FALSE}
library(tidyverse)
library(coin)
```


<p dir="RTL">
۱. شرکتی میخواهد تحقیق کند آیا درآمد نمایندگی های آن یکسان است. برای بررسی این موضوع هشت نمایندگی
به طور تصادفی انتخاب شده اند که به ترتیب میزان فروش آنها عبارت است از 
102, 300, 102, 100, 205, 105, 71 , 92.
با توجه به داده آیا عملکرد نمایندگی ها یکسان است؟
</p>

<h3 dir="RTL">
پاسخ :
</h3>

<p dir ="RTL">
در این سوال از chi_square goodness of fit استفاده می کنیم.
به این صورت که ۸ شرکت مختلف به عنوان کلاس ها در نظر گرفته می شوند و فرض صفر این است که شرکت ها عملکرد یکسانی دارند.
</p>

```{r}
d1 = c( 102, 300, 102, 100, 205, 105, 71 , 92)
prob = c(0.125, 0.125, 0.125, 0.125, 0.125, 0.125, 0.125, 0.125)
chisq.test(d1, p = prob)
```

<p dir="RTL">
بنابراین طبق مقدار p-value شرکت ها عملکرد یکسانی ندارند.
(پاسخ تست با توجه به داده ۳۰۰ منطقی به نظر می رسد.!)
</p>
***

<p dir="RTL">
۲. آمار فروش شرکتی در دو نوع شعبه سنتی و مدرن در زیر آمده است:
</p>

Classical stores: 50, 50, 60, 70, 75, 80, 90, 85

Modern stores: 55, 75, 80, 90, 105, 65

<p dir="RTL">
آیا تفاوتی در عملکرد دو نوع شعبه وجود دارد؟
</p>

<h3 dir="RTL">
پاسخ :
</h3>

<p dir="RTL">
برای مقایسه عملکرد این دو دسته از permutation test استفاده می کنیم.
(با توجه به تعداد کم داده)
</p>

```{r}
d2 = data.frame(sale = c(50, 50, 60, 70, 75, 80, 90, 85,55, 75, 80, 90, 105, 65),
                treatment = factor(c(rep("A",8), rep("B",6))))
coin::oneway_test(sale~treatment, data=d2, distribution="exact")
```

<p dir="RTL">
با توجه به مقدار p-value نمی توان نتیجه گرفت که عملکرد ها متفاوت است.
</p>
***

<p dir="RTL">
۳. اطلاعات حسابداری ۱۵ شعبه که به صورت تصادفی انتخاب شده اند به شرح زیر است:
</p>

509, 517, 502, 629, 830, 911, 847, 803, 727, 853, 757, 730, 774, 718, 904

<p dir="RTL">
شرکت مذکور برای ارتقای فروش خود یک طرح تبلیغاتی جدید را اجرا میکند. پس از طرح جدید نتایج عملکرد شعبه ها  به صورت زیر 
اندازه گیری شده است
</p>

517, 508, 523, 730, 821, 940, 818, 821, 842, 842, 709, 688, 787, 780, 901

<p dir="RTL">
آیا تبلیغات جدید عملکرد فروش را بالا برده است؟
</p>

<h3 dir="RTL">
پاسخ :
</h3>

<p dir="RTL">
اگر داده را به صورت pair در نظر بگیریم از wilcox.test برای مقایسه عملکرد استفاده می کنیم و نتیجه به صورت زیر می شود.
</p>

```{r, warning=FALSE}
d3 = data.frame(sale = c(509, 517, 502, 629, 830, 911, 847, 803, 727, 853, 757, 730, 774, 718, 904,
                         517, 508, 523, 730, 821, 940, 818, 821, 842, 842, 709, 688, 787, 780, 901),
                treatment = factor(c(rep("before",15), rep("after",15))))

before = c(509, 517, 502, 629, 830, 911, 847, 803, 727, 853, 757, 730, 774, 718, 904)
after = c(517, 508, 523, 730, 821, 940, 818, 821, 842, 842, 709, 688, 787, 780, 901)
wilcox.test(after, before, paired = T, alt = "greater")
```

<p dir="RTL">
اگر داده را Pair در نظر نگیریم و ازpermutation test استفاده کنیم نتیجه به صورت زیر است.
</p>

```{r}

coin::oneway_test(sale~treatment, data=d3, distribution="exact")
```
<p dir="RTL">
.در هر دوحالت نمی توان نتیجه گرفت که عملکرد بهتر شده است
</p>

***

<p dir="RTL">
۴. محصولی در سه رنگ سفید آبی و قرمز تولید شده است.
پنج شعبه ار فروشگاه سازنده محصول به صورت تصادفی انتخاب شده و اطلاعات فروش آنها در زیر آمده است.
</p>

| Store | White | Blue | Red |
| :----: | :----: | :----: | :----: |
| 1. |	510 |	925 |	730 |
| 2. | 720 | 735 | 745 |
| 3. |	930 |	753 |	875 |
| 4. |	754 |	685 |	610 |
| 5. |	105	|  |  |

<p dir="RTL">
با توجه به داده های بالا آیا رنگی خاص در میزان فروش محصولات تاثیر دارد؟
</p>

<h3 dir="RTL">
پاسخ :
</h3>

<p dir="RTL">
برای این سوال از friedman test استفاده می کنیم.
</p>

```{r}
d4<-
  matrix(c(510, 925, 730,
           720, 735, 745,
           930, 753, 875,
           754, 685, 610),
         nrow = 4,
         byrow = TRUE,
         dimnames = list(1 : 4,
                         c("W", "B", "R")))
friedman.test(d4)
```

***

<p dir="RTL">
۵. یک موسسه نظرسنجی نظرات مردم در مورد رضایت از یک محصول که در ماه های فروردین اردیبهشت خرداد و تیر که از طریق تلویزیون 
تبلیغ شده است را مورد ارزیابی قرار می دهد.این کار بدین صورت است از افرادی در ماه اول سوال پرسیده می شود و در ماه آینده نیز از همان فرد سوال می شود که آیا از محصول مذکور راضی هستی یا خیر.
با توجه به داده ایی که در پیوست تمرین آمده است آیا تبلیغات تاثیر مثبتی در افزایش رضایت مردم داشته است؟
</p>

<h3 dir="RTL">
پاسخ :
</h3>

<p dir="RTL">
برای این سوال از friedman test استفاده می کنیم.
</p>

```{r}
d5 = read_csv("../hw_05/data/tv.csv")
data.matrix(d5) -> d5
friedman.test(d5)

```

***

<p dir="RTL"> 
۶. شرکتی در حال تحقیق بر روی این موضوع است که آیا جمعیت شهر تاثیری در نوع میزان مصرف محصولات شرکت دارد.
با توجه به داده زیر این موضوع را تحقیق کنید؟
</p>


| City size |	| Frequency of service usage | |
| :---: |  :---:  | :---: | :---: | 
| | Always	| Sometime | Never |
| Small	| 151	| 252	| 603 |
| Medium	| 802	| 603	| 405 |
| Large	| 753	| 55	| 408 |

<h3 dir="RTL">
پاسخ :
</h3>

<p dir="RTL">
برای این سوال از Chi-squared Test of Independence استفاده می کنیم.
</p>

```{r}
d6<-
  data.frame("city_size" = c("small", "medium", "large"), 
             "always" = c(151, 802, 753),
             "sometime" = c(252, 603, 55),
             "never" = c(603, 405, 408))
d6 %>% .[,-1] %>% as.matrix() -> d6_matrix
rownames(d6_matrix) = d6$city_size
chisq.test(d6_matrix)

```
<p dir="RTL">
بنابراین طبق p-value جمعیت شهر بر میزان مصرف محصولات تاثیر دارد و این دو پارامتر مستقل نیستند.
</p>

***

<p dir="RTL"> 
۷. شرکتی انتظار دارد با ارایه محصول الف میزان فروش محصول ب افزایش یابد.
به همین منظور به طور تصادفی از صد مشتری خود اطلاعات مصرف جمع آوری می نماید.
با توجه به داده های که داده شده آیا ربط معناداری بین فروش این دو محصول وجود دارد؟
</p>

<h3 dir="RTL">
پاسخ :
</h3>

<p dir="RTL">
برای این سوال از cor با روش spearman استفاده می کنیم.
</p>

```{r, warning=FALSE}
d7 = read_csv("../hw_05/data/consumption.csv")
cor.test(d7$A, d7$B, method = "spearman")
```

<p dir="RTL">
بنابراین ربط معناداری بین فروش این دو محصول وجود ندارد.
</p>

```{r}
cor.test(d7$A, d7$B, method = "spearman", alt = "greater")
```

<p dir="RTL">
بنابراین تاثیر مثبت نیز ندارد.
</p>
***

<p dir="RTL"> 
۸. یک شرکت از ۲۰۰۰ نفر از مشتریان خود عامل خرید محصول را مورد سوال قرار میدهد 
که خلاصه اطلاعات آن را در زیر می توانید مشاهده کنید
</p>

| Characteristics	| Male	| Female |
| :---: |  :---:  | :---: |
| Price	| 301	| 502 |
| Design	| 353	| 155 |
| Color	| 558	| 153 |

<p dir="RTL"> 
آیا جنسیت تاثیری در مشخصه کاربری کالا دارد؟
</p>


<h3 dir="RTL">
پاسخ :
</h3>

<p dir="RTL">
برای این سوال از Chi-squared Test of Independence استفاده می کنیم.
</p>

```{r}
d8<-
  data.frame("Characteristics" = c("price", "design", "color"), 
             "male" = c(301, 353, 558),
             "female" = c(502, 155, 153))
d8 %>% .[,-1] %>% as.matrix() -> d8_matrix
rownames(d8_matrix) = d8$Characteristics
View(d8_matrix)
chisq.test(d8_matrix)

```
<p dir="RTL">
بنابراین طبق p-value جنسیت بر مشخصه کاربری کالا تاثیری نداردواین دو پارامتر از هم مستقل هستند.
</p>


